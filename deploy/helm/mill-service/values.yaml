# Mill Service Helm Chart Values
# ================================

# -- Number of replicas
replicaCount: 1

# -- Image configuration
image:
  repository: mill-service
  tag: "latest"
  pullPolicy: IfNotPresent

# -- Image pull secrets for private registries
imagePullSecrets: []
# - name: my-registry-secret

# -- Override chart name
nameOverride: ""
fullnameOverride: ""

# -- Service account configuration
serviceAccount:
  create: true
  automount: true
  annotations: {}
  name: ""

# -- Pod annotations
podAnnotations: {}

# -- Pod labels
podLabels: {}

# -- Pod security context
podSecurityContext: {}
  # fsGroup: 2000

# -- Container security context
securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

# -- Service configuration
service:
  type: ClusterIP
  # HTTP port for REST API and web UI
  httpPort: 8080
  # gRPC port for Mill protocol
  grpcPort: 9099

# -- Resource limits and requests
resources: {}
  # limits:
  #   cpu: 2000m
  #   memory: 2Gi
  # requests:
  #   cpu: 500m
  #   memory: 512Mi

# -- Node selector
nodeSelector: {}

# -- Tolerations
tolerations: []

# -- Affinity rules
affinity: {}

# -- Liveness probe configuration
livenessProbe:
  httpGet:
    path: /actuator/health/liveness
    port: http
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

# -- Readiness probe configuration
readinessProbe:
  httpGet:
    path: /actuator/health/readiness
    port: http
  initialDelaySeconds: 10
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 3

# =================================
# Application Configuration
# =================================

# -- Command line arguments passed to mill-service
# Example: ["--spring.profiles.active=prod", "--server.port=8080"]
args: []

# -- Additional environment variables (non-sensitive)
env: []
# - name: JAVA_OPTS
#   value: "-Xmx1g -Xms512m"
# - name: SPRING_PROFILES_ACTIVE
#   value: "prod"

# -- Environment variables from ConfigMap or Secret references
envFrom: []
# - configMapRef:
#     name: my-config
# - secretRef:
#     name: my-secret

# -- Application configuration settings
config:
  # -- Enable ConfigMap-based application.yml (set to false for pre-configured images)
  enabled: true

# -- Application configuration (will be mounted as application.yml)
# This is your main Spring Boot configuration (only used when config.enabled=true)
applicationConfig: |
  spring:
    datasource:
      url: jdbc:h2:mem:db;DB_CLOSE_DELAY=-1
      username: sa
      password: sa
    main:
      web-application-type: servlet
    ai:
      model:
        chat: none
        audio:
          speech: none
          transcription: none
        embedding: none
        image: none
        moderation: none

  mill:
    metadata:
      relations: none
      annotations: none
    services:
      ai-nl2data:
        enable: false
      grinder:
        enable: false
      meta:
        enable: true
      jet-http:
        enable: true
      grpc:
        port: 9099
        enable: true
        address: '*'
      data-bot:
        enable: false

  grpc:
    server:
      port: 9099
      address: '*'

  logging:
    level:
      root: info

# =================================
# Secrets Configuration
# =================================
# Secrets are mapped to environment variables.
# For production, consider using External Secrets Operator or Sealed Secrets.

secrets:
  # -- Create a Kubernetes Secret with the values below
  create: true
  # -- Name of existing secret to use (if create is false)
  existingSecretName: ""
  # -- Secret data (key: value pairs become environment variables)
  # Values should be base64 encoded in production or use --set-string
  data: {}
    # SPRING_AI_OPENAI_API_KEY: "your-openai-api-key"
    # SPRING_AI_AZURE_OPENAI_API_KEY: "your-azure-openai-key"
    # SPRING_DATASOURCE_PASSWORD: "db-password"

# =================================
# Additional Volumes
# =================================

# -- Extra volumes to mount
extraVolumes: []
# - name: data
#   persistentVolumeClaim:
#     claimName: mill-data-pvc

# -- Extra volume mounts
extraVolumeMounts: []
# - name: data
#   mountPath: /data
